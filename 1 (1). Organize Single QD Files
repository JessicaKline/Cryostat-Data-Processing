{"cells":[{"cell_type":"code","source":["## Organize files from single QDs measurements into a consistent structure\n","## directory/QD {n}/APD/ will contain all TTTR data (.parquet and .ttbin files)\n","## directory/QD {n}/Spectra/ will contain all spectral data (.csv and .spe files)"],"metadata":{"id":"v30Vhyq5brZG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#@title imports\n","#### Common Imports #####\n","\n","import matplotlib.pyplot as plt\n","import numpy as np\n","import pandas as pd\n","from matplotlib.ticker import MultipleLocator\n","import math\n","import os\n","from os import listdir\n","from os.path import isfile, join\n","import logging\n","from scipy import optimize\n","import seaborn as sns\n","\n","import shutil\n","#### Common Imports #####\n","\n","#### RC Params #####\n","\n","plt.rcParams['savefig.dpi'] = 300\n","plt.rcParams['font.size'] = 22\n","plt.rcParams['font.family'] = 'sans-serif'\n","plt.rcParams['font.sans-serif'] = 'Arial'\n","plt.rcParams['xtick.major.pad']='10'\n","plt.rcParams['ytick.major.pad']='4'\n","\n","logging.getLogger('matplotlib.font_manager').disabled = True\n","\n","#### RC Params #####"],"metadata":{"cellView":"form","id":"vJBJ6EQftMYy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#@title helper functions\n","\n","#### Common Helper Functions #####\n","\n","def read_csv(file_path):\n","  g2 = pd.read_csv(file_path)\n","  g2 = g2.to_numpy()\n","  return g2\n","\n","def save_fig(filename):\n","  plt.savefig(filename, bbox_inches = 'tight')\n","\n","def set_figsize(width_, height_):\n","  ff = plt.gcf()\n","  ff.set_figwidth(width_)\n","  ff.set_figheight(height_)\n","  ff.tight_layout()\n","\n","def tick_settings(x_minor = 1, y_minor = 1):\n","  plt.gca().xaxis.set_minor_locator(MultipleLocator(x_minor))\n","  plt.gca().yaxis.set_minor_locator(MultipleLocator(y_minor))\n","  plt.gca().tick_params(which='minor', bottom=True, top=True, left=True, right=True)\n","  plt.gca().tick_params(bottom=True, top=True, left=True, right=True)\n","  plt.tick_params(axis = 'both', direction = 'in', length = 6, width = 1.5)\n","  plt.gca().tick_params(which='minor', direction = \"in\", length = 4, width = 0.75)\n","\n","  for axis in ['top','bottom','left','right']:\n","    plt.gca().spines[axis].set_linewidth(1.5)\n","\n","def plot_settings(y_lim, x_lim, y_min, x_min, x_label, y_label):\n","  plt.gca().set_ylim(y_lim)\n","  plt.gca().set_xlim(x_lim)\n","  tick_settings(y_minor = y_min, x_minor = x_min)\n","\n","  plt.gca().set_xlabel(x_label, fontweight = 'bold')\n","  plt.gca().set_ylabel(y_label, fontweight = 'bold')\n","\n","def save_csv_report(fits, col_lst ,filename):\n","  fits = pd.DataFrame(fits.T)\n","  fits.columns = col_lst\n","  fits.to_csv(filename)\n","\n","def find_nearest(array, value):\n","    array = np.asarray(array)\n","    idx = (np.abs(array - value)).argmin()\n","    return idx\n","\n","def get_onlyfile(folder):\n","  return [f for f in listdir(folder) if isfile(join(folder, f))]\n","\n","#### Common Helper Functions #####\n","\n","def jacobian_transform(x_w, I_w):\n","  hc = 1239.8\n","\n","  x_E_ev = hc/x_w\n","  x_frequency = 3E8/(x_w*1E-9)\n","  I_E = I_w/(x_E_ev**2)\n","  I_E = I_E/(x_frequency**3)\n","  #I_E = I_E/np.sum(I_E)\n","  #I_E = I_E / np.amax(I_E)\n","\n","  return np.array([x_E_ev, I_E]).T\n","\n","def gaussian(x, amplitude1, mean1, stddev1):\n","    return amplitude1/(stddev1*np.sqrt(2*3.14)) * np.exp(-0.5*((x - mean1) /(stddev1))**2)\n","\n","def gaussian_b(x, amplitude1, mean1, stddev1, b):\n","    return amplitude1/(stddev1*np.sqrt(2*3.14)) * np.exp(-0.5*((x - mean1) /(stddev1))**2) + b\n","\n","def gaussian2(x, amplitude1, mean1, stddev1, amplitude2, mean2, stddev2):\n","    return amplitude1/(stddev1*np.sqrt(2*3.14)) * np.exp(-0.5*((x - mean1) /(stddev1))**2) + amplitude2/(stddev2*np.sqrt(2*3.14)) * np.exp(-0.5*((x - mean2) /(stddev2))**2)\n","\n","def gaussian3(x, amplitude1, mean1, stddev1, amplitude2, mean2, stddev2, amplitude3, mean3, stddev3):\n","    return amplitude1/(stddev1*np.sqrt(2*3.14)) * np.exp(-0.5*((x - mean1) /(stddev1))**2) + amplitude2/(stddev2*np.sqrt(2*3.14)) * np.exp(-0.5*((x - mean2) /(stddev2))**2) + amplitude3/(stddev3*np.sqrt(2*3.14)) * np.exp(-0.5*((x - mean3) /(stddev3))**2)"],"metadata":{"id":"LLI7xFaAtS5J","cellView":"form"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["directory = 'insert file path here'\n","\n","all_files = get_onlyfile(directory)\n","\n","for qd_num in range(0,200):\n","\n","  tag = f'QD{qd_num}_'\n","  mask = [True if tag in f else False for f in all_files]\n","\n","  if np.sum(mask) > 0:\n","    qd_num_path = directory + f'QD{qd_num}/'\n","    apd_loc_path = qd_num_path + 'APD/'\n","    spectra_loc_path = qd_num_path + 'Spectra/'\n","\n","    if os.path.exists(qd_num_path) == False:\n","      os.mkdir(qd_num_path)\n","    if os.path.exists(apd_loc_path) == False:\n","      os.mkdir(apd_loc_path)\n","    if os.path.exists(spectra_loc_path) == False:\n","      os.mkdir(spectra_loc_path)\n","\n","    tag_apd1 = '.parquet'\n","    tag_apd2 = '.ttbin'\n","    mask_apd = [True if (tag in f) and ((tag_apd1 in f) or (tag_apd2 in f)) else False for f in all_files]\n","\n","    tag_s1 = '.csv'\n","    tag_s2 = '.spe'\n","    mask_s = [True if (tag in f) and ((tag_s1 in f) or (tag_s2 in f)) else False for f in all_files]\n","\n","    for n in range(len(all_files)):\n","      if mask_apd[n]:\n","        shutil.move(directory+all_files[n], apd_loc_path+all_files[n])\n","      if mask_s[n]:\n","        shutil.move(directory+all_files[n], spectra_loc_path+all_files[n])"],"metadata":{"id":"WrDdSM3d9ggQ"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyNBOKj08qMAcT/RDd6R7x0B"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}